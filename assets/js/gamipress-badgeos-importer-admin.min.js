(function($){var prefix='gamipress_badgeos_importer_';var first_run=!0;var current_process=0;var process=['achievements','steps','points',];function gamipress_badgeos_migrate(show_info){if(show_info===undefined)
show_info=!0;if(process[current_process]===undefined){$('#'+prefix+'response').find('.spinner').remove();$('#'+prefix+'run').prop('disabled',!1);current_process=0;$('#'+prefix+'response').append('<br>Process finished succesfully!');return}else if(show_info){$('#'+prefix+'response').append('<br>Migrating '+process[current_process]+'...')}
$.ajax({url:ajaxurl,data:{action:prefix+'import_'+process[current_process],first_run:(first_run?1:0),points_points_type:$('#'+prefix+'points_points_type').val(),override_points:($('#'+prefix+'override_points').prop('checked')?1:0),},success:function(response){first_run=!1;var running_selector=$('#'+prefix+'response #running-'+process[current_process]);if(response.data.run_again!==undefined&&response.data.run_again){if(response.data.message!==undefined){if(!running_selector.length){$('#'+prefix+'response').append('<br><span id="running-'+process[current_process]+'"></span>');running_selector=$('#'+prefix+'response #running-'+process[current_process])}
running_selector.html(response.data.message)}
gamipress_badgeos_migrate(!1)}else{if(running_selector.length){running_selector.prev('br').remove();running_selector.remove()}
$('#'+prefix+'response').append('<br>'+response.data);current_process++;setTimeout(gamipress_badgeos_migrate,500)}},error:function(response){$('#'+prefix+'response').append('<br>'+'<span style="color: #a00;">'+response.data!==undefined?response.data:'Internal server error'+'</span>');return}})}
$('#'+prefix+'run').click(function(e){e.preventDefault();var $this=$(this);$this.prop('disabled',!0);if($('#'+prefix+'response').length)
$('#'+prefix+'response').remove();$this.parent().append('<div id="'+prefix+'response"><span class="spinner is-active" style="float: none;"></span></div>');if($('#'+prefix+'import_earnings').prop('checked'))
process.push('earnings');if($('#'+prefix+'import_logs').prop('checked'))
process.push('logs');first_run=!0;gamipress_badgeos_migrate()})})(jQuery)